https://github.com/docker/docker/blob/master/docs/userguide/networking/get-started-overlay.md

# swarm master
docker-machine create \
               -d virtualbox \
                   --virtualbox-memory 2048 \
                   --virtualbox-cpu-count 2 \
                   --virtualbox-disk-size 10240 \
               --swarm \
               --swarm-master \
               --swarm-discovery="consul://$(docker-machine ip mh-keystore):8500" \
               --engine-opt="cluster-store=consul://$(docker-machine ip mh-keystore):8500" \
               --engine-opt="cluster-advertise=eth1:2376" \
               host1

# swam additional node
docker-machine create \
              -d virtualbox \
                  --virtualbox-memory 2048 \
                  --virtualbox-cpu-count 2 \
                  --virtualbox-disk-size 10240 \
              --swarm \
              --swarm-discovery="consul://$(docker-machine ip mh-keystore):8500" \
              --engine-opt="cluster-store=consul://$(docker-machine ip mh-keystore):8500" \
              --engine-opt="cluster-advertise=eth1:2376" \
              host2

# create a multi-host network
docker network create -d overlay nifi

# start the cluster
docker-compose --x-networking up
